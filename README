# uosp

Collection of commands helping managing Ubuntu OpenStack packages.

Most of them are actually wrapper until to write everything in pure
Rust. *You may need to install lot of dependencies.*

## Usage


```
$ uosp help

uosp 0.1.0
Sahid Orentino Ferdjaoui <sahid.ferdjaoui@canonical.com>

USAGE:
    uosp <SUBCOMMAND>

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

SUBCOMMANDS:
    build       Build the Ubuntu package.
    clone       Git clone OpenStack package from Ubuntu repository.
    help        Prints this message or the help of the given subcommand(s)
    publish     Publish package to launchpad.
    pushlp      Force push branch on a git launchpad account.
    rebase      Rebase package to a new upstream release.
    snapshot    Update an Ubuntu package to a new upstream snapshot.
```

### Rebasing OpenStack Package

The process is to create point release based on the last version
published upstream. Running this command will clone project name using
package VCS (see: --git-url <URL> if VCS not right). Using uscan to
download tarball of the proposed version and import it using
gbpimport-orig. Finally update the d/changelog and commit the all in
git repo.


```
uosp-rebase 0.1.0
Rebase package to a new upstream release.

USAGE:
    uosp rebase [OPTIONS] <PACKAGE> <VERSION>

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

OPTIONS:
    -b, --bugid <bugid>        Launchpad bug ID associated to the rebase (e.g: 123456).
    -d, --dist <dist>          Indicate the distribution for this package, this help determining version and change log
                               message. [default: ubuntu]  [values: ubuntu, debian]
    -k, --kind <kind>          Indicate what kind of package it is, this help determining version and change log
                               message. [default: openstack]  [values: openstack, regular]
    -r, --release <release>    Openstack release name. (e.g. stein). Default will be to consider to use the in-progress
                               release 'master'. [default: master]

ARGS:
    <PACKAGE>    The package name. (e.g. nova).
    <VERSION>    Openstack version to rebase on. (e.g. 19.0.1).

```
  
#### Example


```
uosp rebase python-os-service-types 1.7.0
Rebasing python-os-service-types master to new upstream version '1.7.0'...
Cloning into 'python-os-service-types'...
remote: Counting objects: 268, done.
remote: Compressing objects: 100% (244/244), done.
remote: Total 268 (delta 126), reused 0 (delta 0)
Receiving objects: 100% (268/268), 69.65 KiB | 758.00 KiB/s, done.
Resolving deltas: 100% (126/126), done.
Branch 'pristine-tar' set up to track remote branch 'pristine-tar' from 'origin'.
Switched to a new branch 'pristine-tar'
Branch 'upstream' set up to track remote branch 'upstream' from 'origin'.
Switched to a new branch 'upstream'
Switched to branch 'master'
Your branch is up to date with 'origin/master'.
uscan: Newest version of python-os-service-types on remote site is 1.7.0, specified download version is 1.7.0
Successfully renamed ../os-service-types-1.7.0.tar.gz to ../python-os-service-types_1.7.0.orig.tar.gz.
gbp:info: Importing '../python-os-service-types_1.7.0.orig.tar.gz' to branch 'upstream'...
gbp:info: Source package is python-os-service-types
gbp:info: Upstream version is 1.7.0
gbp:info: Replacing upstream source on 'master'
gbp:info: Successfully imported version 1.7.0 of ../python-os-service-types_1.7.0.orig.tar.gz
git commit -m 'New upstream release for OpenStack Train.' -a
[master 675376a] New upstream release for OpenStack Train.
 1 file changed, 6 insertions(+)
commit 675376ad66cabdc08b7706e95bb44087643df1c9 (HEAD -> master)
Author: Sahid Orentino Ferdjaoui <sahid.ferdjaoui@canonical.com>
Date:   Thu Jun 27 16:04:13 2019 +0200

    New upstream release for OpenStack Train.

diff --git a/debian/changelog b/debian/changelog
index fcf732d..15819b6 100644
--- a/debian/changelog
+++ b/debian/changelog
@@ -1,3 +1,9 @@
+python-os-service-types (1.7.0-0ubuntu1) UNRELEASED; urgency=medium
+
+  * New upstream release for OpenStack Train.
+
+ -- Sahid Orentino Ferdjaoui <sahid.ferdjaoui@canonical.com>  Thu, 27 Jun 2019 16:04:13 +0200
+
 python-os-service-types (1.6.0-0ubuntu1) disco; urgency=medium
 
   * New upstream release for OpenStack Stein.
done.
```

### Upstream snapshot

```
uosp-snapshot 0.1.0
Update an Ubuntu package to a new upstream snapshot.

USAGE:
    uosp snapshot [OPTIONS] <project> <version>

FLAGS:
    -h, --help       Prints help information
    -V, --version    Prints version information

OPTIONS:
    -u, --upstream <upstream>    Upstream name used to grab source on github. (e.g. trove).

ARGS:
    <project>    Openstack package name. (e.g. nova).
    <version>    The next OpenStack version. (e.g. 19.0.1~b1).
```


